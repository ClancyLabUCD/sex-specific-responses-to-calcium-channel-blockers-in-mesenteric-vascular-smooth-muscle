set(gcf,'color','w');
set(groot, 'defaultLineLineWidth', 1.5)
set(groot, 'defaultAxesFontSize', 20)

data1 = load('model_01.txt');
x1 = data1(:,1);
x2 = data1(:,2);
x3 = data1(:,3);
x4 = data1(:,4);
x5 = data1(:,5);
x6 = data1(:,6);

%Data 
y1 = [-80	-70	-60	-50	-40	-30	-20	-10	0	10	20	30	40	50	60	];
%IV not normalized
y2 =[0	0	0	0	-1.2216	-3.5333	-17.2084	-44.7203	-74.421	-77.3882	-61.63409299	-37.21322593	-9.455219718	3.733394371	12.38297986	];
%Erros
y3 =[0	0	0	0	0.743983142	1.27284428	3.760559812	9.095437256	15.0333191	15.39606608	12.5526267	8.481036209	6.232871418	6.936630329	7.79425291	];

%Activation
y4 =[0	0	0	0	0.003364229	0.01221252	0.077455669	0.273310708	0.663839339	1	1	1	1	1	1];
%Error
y5 =[0.003995748	0.002542189	0.002725398	0.002914681	0.004861807	0.007736462	0.014678028	0.035504006	0.05618306	0.070625912	0.056912581	0.034948762	0.056458063	0.074366509	0.199443025	];

%Inactivation
y6 =[0.912819054	0.928813634	0.900666655	0.875635972	0.807846832	0.615697154	0.4054707	0.242378956	0.160415345	0.13712343	0.121180083	0.0152209633	0.0185402212	0.0243814457	0.0294767619	];
%Error
y7=[0.036451867	0.022204577	0.021540046	0.028455788	0.034187092	0.045086323	0.054750149	0.040096832	0.031947519	0.028189384	0.030008501	0.034686533	0.03347627	0.039982501	0.051411162	];

%Activation taus 
ys = [-80	-70	-60	-50	-40	-30	-20	-10	0	10	20	30	40	50	60];
y8 = [2	1.805	2.0125	2.2125	2.074444444	2.3	2.764545455	3.288181818	3.423333333	2.856666667	2.448333333	2.033333333	1.774545455	1.912727273	1.576363636	];
y9 =[0.784920378	0.145296631	0.2	0.04	0.189686458	0.302070632	0.293357007	0.37783047	0.529376234	0.376544146	0.211993041	0.149682792	0.211829188	0.205131695	0.427326764	];
%Activation taus 

y10 = [112.3075	176.5366667	133.705	160.1364	130.5228571	146.3966667	114.8833333	174.242	173.7444444	133.0326667	114.282	101.3038333	92.61666667	79.312	67.2853625];
y11 = [17.23860908	38.99145205	17.29643509	25.03597412	19.64589298	27.17845871	40.21852503	28.07955601	12.53666539	9.331271813	7.139376421	5.263354209	8.38808679	10.04788535	6.263319141];



figure (10)
set(gcf,'color','w');
errorbar(y1,y2,y3,'sc', 'LineWidth',1.2,'MarkerSize',10)
hold on
plot(x1,x4,'c', 'LineWidth',2)
axis([-60 60 -100 20 ])
ylabel('I_{Ca} (pA)'),xlabel('Voltage (mV)')
legend('Data N = 12','Model')

figure (20)
set(gcf,'color','w');
errorbar(y1,y4,y5,'sc', 'LineWidth',1.2,'MarkerSize',10)
hold on
plot(x1,x2,'c', 'LineWidth',2)
axis([-60 60 0 1 ])
ylabel('pA'),xlabel('Voltage (mV)')
hold on
errorbar(y1,y6,y7,'sc', 'LineWidth',1.2,'MarkerSize',10)
hold on
plot(x1,x3,'c', 'LineWidth',2)
axis([-60 60 0 1 ])
ylabel('Ca_{V}1.2 G/G_{max}'),xlabel('Voltage (mV)')
legend('Data N = 12','Model')


figure (30)
set(gcf,'color','w');
errorbar(ys,y8,y9,'sc', 'LineWidth',1.2,'MarkerSize',10)
xticks([-60, -40, -20, 0, 20, 40, 60])
ylabel('\tau_{Activation}'),xlabel('Voltage (mV)')
hold on
plot(x1,x5,'c', 'LineWidth',2)
axis([-60 60 0 5 ])
legend('Data N = 12','Model')

figure (40)
set(gcf,'color','w');
errorbar(ys,y10,y11,'sc', 'LineWidth',1.2,'MarkerSize',10)
xticks([-60, -40, -20, 0, 20, 40, 60])
ylabel('\tau_{Inactivation}'),xlabel('Voltage (mV)')
hold on
plot(x1,x6,'c', 'LineWidth',2)
axis([-60 60 0 300 ])
legend('Data N = 12','Model')



