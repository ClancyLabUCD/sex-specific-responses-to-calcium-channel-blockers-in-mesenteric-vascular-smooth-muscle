set(gcf,'color','w');
set(groot, 'defaultLineLineWidth', 1.5)
set(groot, 'defaultAxesFontSize', 20)

data1 = load('model_01.txt');
% data2 = load('results1.txt');

x1 = data1(:,1);
x2 = data1(:,2);
x3 = data1(:,3);
x4 = data1(:,4);
x5 = data1(:,5);
x6 = data1(:,6);

y1 = [-80	-70	-60	-50	-40	-30	-20	-10	0	10	20	30	40	50	60];
%Data IV
y2 =[0	0	0	0	-0.5	-2.7703	-11.7254	-27.8612	-42.6211	-46.2051	-33.10479641	-17.80463281	-6.082811117	13.70904558	11.26948622	];
y3 = [0	0	0	0	1.299411531	2.206903633	4.005455233	6.744379187	7.597769411	7.69263528	7.06332023	6.194476951	4.241362906	13.32159951	6.031335668	];

%GHK Activation 
y4=[0	0	0	0	0.002306276	0.016037491	0.088394494	0.285191507	0.636761751	1	1	1	1	1	1];
y5 =[0.005515591	0.003982387	0.007262363	0.011288517	0.009085753	0.016612367	0.030036945	0.049566489	0.046658177	0.021320047	0.022502137	0.062941159	0.066836887	0.061431159	0.0614364218	];


%GHK Inactivation 
y6=[0.968075909	0.963447109	0.952905658	0.941429239	0.821525532	0.651763564	0.436892473	0.255534784	0.162872685	0.119716427	0.127941006	0.159243943	0	0	0];
y7=[0.010215517	0.01360165	0.01424941	0.021572672	0.041086892	0.051410542	0.057476528	0.038445194	0.023122705	0.020582788	0.01616925	0.009965288	0.021536765	0.06177793664	0.08127472497	];



ys = [-80	-70	-60	-50	-40	-30	-20	-10	0	10	20	30	40	50	60];
%Activation taus
y8 =[2	2	2	2.12	1.885555556	1.81625	2.6	3.464444444	3.884444444	3.182222222	2.287777778	1.882222222	1.757777778	1.83	1.867142857];
%error
y9 =[0.328447527	0.152752523	0.185592145	0.616965693	0.198415492	0.302070632	0.293357007	0.37783047	0.529376234	0.376544146	0.211993041	0.149682792	0.211829188	0.205131695	0.427326764];

%Inactivation taus
y10 =[160.865	163.6625	182.56	191.065	215.512	198.534	162.0733333	158.835	164.70875	156.4	103.4511111	107.5155556	69.4825	78.585	82.198];
%error
y11 =[23.17820456	26.95356089	15.48353965	33.91065319	19.69923856	22.28402959	41.3314393	37.83553927	13.85351882	20.12190052	7.139376421	5.263354209	2.644662471	11.114633	10.77651768];


figure (1)
set(gcf,'color','w');
errorbar(y1,y2,y3,'ok', 'LineWidth',1.2,'MarkerSize',10)
hold on
plot(x1,x4,'k', 'LineWidth',2)
axis([-60 60 -100 20 ])
ylabel('I_{Ca} (pA)'),xlabel('Voltage (mV)')
legend('Data N = 10','Model')

figure (2)
set(gcf,'color','w');
errorbar(y1,y4,y5,'ok', 'LineWidth',1.2,'MarkerSize',10)
hold on
plot(x1,x2,'k', 'LineWidth',2)
axis([-60 60 0 1 ])
ylabel('pA'),xlabel('Voltage (mV)')
errorbar(y1,y6,y7,'ok', 'LineWidth',1.2,'MarkerSize',10)
hold on
plot(x1,x3,'k', 'LineWidth',2)
axis([-60 60 0 1 ])
ylabel('Ca_{V}1.2 G/G_{max}'),xlabel('Voltage (mV)')
legend('Data N = 10','Model')

figure (3)
set(gcf,'color','w');
errorbar(ys,y8,y9,'ok', 'LineWidth',1.2,'MarkerSize',10)
ylabel('\tau_{Activation}'),xlabel('Voltage (mV)')
hold on
plot(x1,x5,'k', 'LineWidth',2)
axis([-60 60 0 5 ])
legend('Data N = 10','Model')

figure (4)
set(gcf,'color','w');
errorbar(ys,y10,y11,'ok', 'LineWidth',1.2,'MarkerSize',10)
ylabel('\tau_{Inactivation}'),xlabel('Voltage (mV)')
hold on
plot(x1,x6,'k', 'LineWidth',2)
axis([-60 60 0 300])
legend('Data N = 10','Model')

